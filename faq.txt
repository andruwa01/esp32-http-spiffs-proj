Important details

[x] Чтобы не было проблемы с https (и http) можно осуществить отключение валидации сервера 
    https://esp32.com/viewtopic.php?t=19200

! mbedTLS -> Certificate Bundle → Enable trusted root certificate bundle 
  на сайте https://kotyara12.ru/iot/espidf_config/ указано, что включенная опция есть много памяти, и у меня эта штука ВКЛЮЧЕНА  
[x] Почитать про ошибку с watchdog timer в моём случае при добавлении #define SPIFFS_CHECK_ON_START
    ! При добавлении SPIFFS_CHECK_ON_START флага в main.h срабатывает watchdog timer
    https://github.com/espressif/esp-idf/issues/1646
    https://github.com/espressif/arduino-esp32/issues/3871
[x] Ошибка, когда intelliSense не видит заголовочных файлов, но при этом build проекта осуществляется успешно
    Решение:
    https://github.com/espressif/vscode-esp-idf-extension/blob/master/docs/C_CPP_CONFIGURATION.md [x] Проблема: вылезает ошибка , но макет с sx1278 прошивается (). Ошибка, срабатывает таймер watchdog.
    Проблема возникает из-за того, что при выборе target esp32s3 в menuconfig перезаписываются значения пинов и потом их Нужно
    записывать заново
    Решение:
    Правильно настроить порты в menuconfig (или sdkconfig). При этом можно автоматически выставить 
#
# Example Configuration
#
CONFIG_LED_GPIO=2
CONFIG_PIN_NUM_MOSI=11
CONFIG_PIN_NUM_MISO=13
CONFIG_PIN_NUM_CLK=12
CONFIG_PIN_NUM_SX1278_CS=4
CONFIG_PIN_NUM_SX1278_NRESET=6
CONFIG_PIN_NUM_SX1278_DIO1=5
CONFIG_SPI_CLOCK_SPEED=10000000

[x] Проблема: в vscode переменные становятся белыми
    Решение: поменять режим C_Cpp.intelliSenseMode в .vscode/settings.json

[x] Важная особенность организации фацловой системы spiffs
!!!
    // The file alice.txt lives under a subdirectory, though SPIFFS itself is flat
    FILE* f = fopen("/spiffs/sub/alice.txt", "r");
    if (f == NULL) {
        ESP_LOGE(TAG, "Failed to open alice.txt");
        return;
    }
!!!

//TODO
// ERRORS & QUESTIONS
[] По какой-то причине оставляет 3765 байт в spiffs при загрузке, не понимаю почему так получилось
   , пробовал всё чистить - значит по какой-то причине такое возникает, когда spiffs только инициализируется
   Возможно так и должно быть, правда я не понимаю почему так.

// потом, если нужно будет
[] Сделать так, чтобы при перезапуске esp файлы в spiffs очищались, но таким образом, чтобы нужные данные оставались, 
   а ненужные исчезали. Пока файлы без ЗНАЧЕНИЙ ПО-УМОЛЧАНИЮ. Можно будет потом их вручную вбивать на стороне pc. 
[x] Реализовать очистку места не ПОСЛЕ выполнение всей программы, а ПЕРЕД

// network module
! Пока сделать всё линейным, потом если надо будет - будем наворачивать
[x] Реализовать wifi , как в примерах с официального репозитория, т.е. чтобы при потере соединения устройство
[] wifi можно усовершенствовать ещё лучше, чтобы даже когда не получалось подключиться ни к чему прога останавливалась
[] Реализовать функцию, чтобы по нажатию кнопки и неудаче получение ответа от сервера - происходило оповещение об этом
[] Сделать чтобы лампочка загоралась, когда было успешное подключение к интернету (сигнал, что можно нажимать на кнопку)
 

// uart module
[] Сделать получение вообще всех данных и запись их в spiffs
    [x] Получить данные и распарсить их для одного спутника
    [x] Сделать возможность перезаписи имеющегося файла в spiffs (по заданному в параметре пути) - будет работать при нажатии кнопки
    [x] Сделать возможность забивать путь в spiffs (потом понадобится, когда этих путей будет несколько)
    [x] Для всех спутников tiny gs.
        [x] Создать разделы для каждого из спутников (заранее взять соответствующие названия)
            [x] Определиться с тем, сколько места нужно в spiffs
                [x] места, которое есть (1мб) более чем достаточно
            [x] Сделать массив строк с назаниями спутников (чтобы затем использовать для создания пути) 
            [x] Проблема: при попытке записать данные http ответа - они записываются не только в файл norbi,
                но и в остальные файлы частично - не пойму почему так происходит
                [x] Вероятно, файлы просто неправильно считываются из-за того, что функция fread не видит null-terminate 
                   символ строки
                [x] Попробовать добавить небольшую задержку перед считыванием данных из spiffs
                [x] Модифицировать код таким образом, чтобы из файлов spiffs считывалось столько байт, сколько 
                   там есть, и не больше. Возможно тогда проблема пропадёт
                   https://stackoverflow.com/questions/238603/how-can-i-get-a-files-size-in-c
                [x] Все вышестоящие шаги решили проблему, основное - null-terminated symbol
            [x] Сделать отдельные папки для каждого из спутников (как уже есть по аналогии с norbi.txt),
                затем ещё добавить в cmakelists.txt spiffs_create_partition_image для каждого спутника
    [] Сделать получение данных по запросу для каждого из спутников
        [] Понять почему происходит panic abort (вероятно не хватает памяти)
        [] понять почему память снова забивается, проверить номера norad спутников, потому что при значении 15 неправильно показываются
        [x] Сделать так, чтобы индексы файлов начинались с 1 для каждого файла, пока они просто считаются постоянно
[] Настроить второй uart для передачи данных на компьютер
    [x] Попробовать передать короткое сообщение, чтобы было видно в putty
    [x] Реализовать кнопку, по нажатию которой данный записывались бы в UART
    [] Сделать, чтобы по нажатию кнопки можно бы было получать данные по сети 
       () при этом гарантируется, что ЕСТЬ соединение с сетью
       [] Сделать загрузку одного файла из компьютера из spiffs
       [] Сделать загрузку всех файлов из компьютера из spiffs
    [] Сделать так, чтобы после выхода из main_task кнопкой пользоваться было нельзя (очистить память)
    [] Написать на питоне прогу, которая занимается записью полученных данных в файлы
        [] Передавать через uart непосредственно json
            [] Данные для ОДНОГО спутника, затем запись его в файл
            [] Данные для всех спутников, затем запись их в файл

    [x] Попробовать передать данные из одного файла spiffs, чтобы было видно в putty
        !!! Попробовал, проще сразу питоновский скрипт написать !!!

[x] Что за dialout пользователь и зачем порт было добавлять а разрешения?

// Tech task
[] Сделать прогу с считыванием данных uart, чтобы можно было по командам делать
   [] Выгрузка файлов из spiffs на компьютер  (предполагаю, что при этом esp32 должна работать
      в режиме подключения к wifi, чтобы отдать данные на UART, можно попробвать сделать вход в этот
      режим через кнопку)
   [] Удаление файлов из spiffs (которые уже на компьютере)
   [] Обновление файлов, которые уже лежат на компьютере (перезапись старых на новые) (при этом проверять
      есть ли подключение к сети)
[] Реализовать планировщик, чтобы по времени доставалось нужное расписание + отдавался приоритет спутнику с большей высотой
[] Разобраться с xEventGroupSetBits
[x] Сформировать правильный sdkconfig.default, который будет в дальнейшем использоваться
[] Ещё раз посмотреть всё переменные где используется память, возможно оптимизировать их как-то
[x] Добавить проверку на то, сколько памяти спользуется в spiffs.
[] Сделать возможность вбивать параметры, по которым будет формироваться запрос на сервер
[] Сделать, чтобы при работающем wifi и наличии подключения горела лампоча

[] Настроить возможность подключатьс япо https сертификат
       https://youtu.be/Dv0APuuHFh8?si=6U2MrLzdfnrta-xL - тут показаны get запросы и как реализуется сертификат
[] попробовать с сертификатом - можно настроить сертификат, но можно сделать это потом
[] Настроить всё с помощью esp tls

// OPTIONAL TODO
[] Что такое прерывания и как они реализованы ? ISR etc
[] Прочитать про backtrace в контексте прерываний
[] Прочитать про build систему espressif и какие там настройки есть (это нужно чтобы правильно скомпилировать
    имеющейся код, только на в eclipse а в vscode). К тому же поможет разобраться в cmake.
        [] файл c_cpp_properties.json и зачем он нужен
        [] файл compile_commands.json и зачем он нужен
[] (тут тоже есть про память) изучить таймеры в esp32 https://kotyara12.ru/iot/esp32_timers/   
[] почитать дополнительно про main task stack size
[] почитать дополнительно про event loop task stack size
[]  High-resolution timer task stack size что это ?
[]  Hardware timer to use for esp_timer что это ?
[x] повторить взаимодействие файлов через fopen , frpintf etc
[] Можно почитать про то, как грамотно использовать stack и проверять его на переполнение
    [] http://microsin.net/programming/arm-troubleshooting-faq/freertos-stack-usage-and-stack-overflow-checking.html
    [] https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/mem_alloc.html
    [] https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/freertos.html?highlight=uxtaskgetsystemstate#_CPPv420uxTaskGetSystemStatePC12TaskStatus_tK11UBaseType_tPC8uint32_t
    [] https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-guides/performance/ram-usage.html

[] Изучить новую плату (в скачанных файлах есть даташиты и тд)
[] Посмотреть исходные коды tiny GS и посмотреть с какими библиотеками они там работают.
[] Прочитать про cmake https://habr.com/ru/articles/155467/
[] JTAG что это и как с этим работать? в stm32 было чтото похожее
    [] https://www.youtube.com/watch?v=uq93H7T7cOQ

// DONE (last done on the top)
[x] Ознакомиться с имеющимися кодами, понять зачем они и перенести их в platformio    
    [x] Попробовать починить любой другой пример => 
    [x] Попробовать починить код, который sx
    [x] Запустить пример espidf
    [x] Воспользоваться не кнопкой build которая cmake , а кнопкой build от самой esp-idf

[x] spiffs под esp idf , файл небольшой 1кб нужно будет создать
    [x] Тут есть про API которое можно вызывать в platformio https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/storage/spiffs.html
    [x] Создать .csv файл с разметкой места во flash памяти  
    [x] Прошить плату с использованием spiffs
    [x] Разобраться с примером, попробовать записать текст в файл и получить его оттуда
[x] Тут в целом про flash память esp32 и о spiffs есть немного там (найти через ctrl + f)  https://kotyara12.ru/iot/esp32_flash/

[x] Почитать в целом про память esp32 https://kotyara12.ru/iot/esp32_memory/ 

[x] разобраться с системой логов esp32 
    [x] В контексте platformio (у неё есть свои настройки monitor_filters в platformio.ini)
        [x] прочитать статью про platformio https://kotyara12.ru/iot/pio_first_project/
        [x] про конфигурацию esp idf https://kotyara12.ru/iot/espidf_config/ 
        [x] esp_log на сайте esp_idf прочитать

[x] Понять, почему логи в Serial выводятся с какими-то странными символами: возможно дело в monitor_filters в platformio.ini
        Нужно в monitor_filter присвоить значение direct. В этом случае выводятся логи без дополнительных символов. 
        Тут можно почитать подробнее:
        https://docs.platformio.org/en/latest/core/userguide/device/cmd_monitor.html#cmd-device-monitor-filters

[x] Найти библиотеку для sx1280(1278) для работы в esp idf
    Библиотеки есть также в скачанном архиве для новой платы, которую принесли
    https://github.com/Inteform/esp32-lora-library
    https://github.com/dernasherbrezon/sx127x - показалась мне наиболее хорошей

[x] Найти библиотеку для работы с LED дисплеем (или можно как-то использовать ардуино?)
    https://docs.espressif.com/projects/esp-idf/en/v5.0/esp32/api-reference/peripherals/lcd.html# - в официальной документации есть информация для работы с этим 
    
[x] Создать Git репозиторий для проекта 